<!DOCTYPE html>
<html>
<head>
	<title>commonfloor</title>

	<meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0" />
	<link rel="shortcut icon" href="images/cf.ico">
	<link href="css/bootstrap/bootstrap.css" rel="stylesheet">
	<link href="css/locality.css" rel="stylesheet">
	<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?v=3.13&libraries=places,geometry,visualization&sensor=true&language=en"></script>
	<script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
	
	<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0/css/select2.min.css" rel="stylesheet" />
	<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.0/js/select2.min.js"></script>
	<script type="text/javascript" src="http://www.parsecdn.com/js/parse-1.2.13.min.js"></script>
	<script>
		var zones;
		var localities;
		var map;
		var infowindow = new google.maps.InfoWindow({});
		function initializeMap(){
			for (var i = 0; i < zones.length; i++) {
         loadZone(zones[i]);                          
      }  
			//console.log(localities);			
		}
		function decodeLevels(encodedLevelsString) {
	    var decodedLevels = [];
	    for (var i = 0; i < encodedLevelsString.length; ++i) {
	        var level = encodedLevelsString.charCodeAt(i) - 63;
	        decodedLevels.push(level);
	    }
	    return decodedLevels;
		}
		function loadZone(zoneData) {                
      var zoneName=zoneData.get("zoneName");
      var polygonEncoded=zoneData.get('polygonEncoded');
      console.log(polygonEncoded);
      var decodedPath = google.maps.geometry.encoding.decodePath(polygonEncoded);
    	var decodedLevels = decodeLevels("BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB");
    	var zonePolygon = new google.maps.Polygon({
        paths: decodedPath,
        strokeColor: '#FF0000',
        strokeOpacity: 0.8,
        strokeWeight: 2,
        fillColor: '#CCC',
        fillOpacity: 0.4
        //levels: decodedLevels,
        //strokeColor: "#FF0000",
        //strokeOpacity: 1.0,
        //strokeWeight: 2
	    });
	    google.maps.event.addListener(zonePolygon, 'mouseover', function (event) {
        infowindow.setContent("<a href='"+"' target='_blank'><b>"+zoneName+"</b></a>");
        infowindow.setPosition(event.latLng);
        infowindow.open(map);
      });
	    zonePolygon.setMap(map);
      /*allPolygons.forEach(function(item, index){
          var bermudaTriangle = new google.maps.Polygon({
              map: map,
              paths: item.point,
              strokeColor: '#FF0000',
              strokeOpacity: 0.8,
              strokeWeight: 2,
              fillColor: '#CCC',
              fillOpacity: 0.4
          });
          map.panTo(new google.maps.LatLng(item.point[0].lat,item.point[0].lng));
          var url="https://www.google.co.in/maps/place/"+localityName+","+$("#city").val();
          google.maps.event.addListener(bermudaTriangle, 'mouseover', function (event) {
              infowindow.setContent("<a href='"+url+"' target='_blank'><b>"+localityName+"</b></a>");
              infowindow.setPosition(event.latLng);
              infowindow.open(map);
          });
      });*/
    }
		function initialize() {
		  var mapProp = {
		    center:new google.maps.LatLng(12.964369, 77.586308),
		    zoom:10,
		    mapTypeId:google.maps.MapTypeId.ROADMAP
		  };
		  map=new google.maps.Map(document.getElementById("googleMap"),mapProp);
		  Parse.initialize("3nP5Zdd4wy72HWQMfCl1OQcBv7iok8d5NPVRlYN5", "ZA9mcuwRZMa0yzJXvBQQ294rKu7vnjXed50JJRjU");
		  var Zone = Parse.Object.extend("Zone");
      var query = new Parse.Query(Zone);
      query.find({
        success: function(results) {
        	zones=results;
      		var MapLocality = Parse.Object.extend("MapLocality");
		      var query2 = new Parse.Query(MapLocality);
		      query2.limit(250);
		      query2.find({
		      	success: function(localityData){
		      		localities=localityData;
		      		initializeMap();
		      	},
        	});
        },
        error: function(error) {
          alert("Error: " + error.code + " " + error.message);
        }
     	});
    }
		google.maps.event.addDomListener(window, 'load', initialize);
	</script>	
</head>
<body>
	<div class="container-fluid">
		<div class="row background">
			<div class="col-md-12 ontopData">
				<div class="col-md-12 topContent">
					<div class="logo">
						<center>
							<a href="http://www.commonfloor.com">
								<img src="../images/logo.png">
							</a>
						</center>
						<button class="pull-right">Login</button>
						<h1>CommonFloor. You are Home.</h1>
					</div>
				</div>
				<div class="col-md-12 contentWrapper">
					<div class="col-md-5 map">
						<div  id="googleMap"></div>
					</div>
					<div class="col-md-7 search">
						<h2>Find your dream property in Bangalore</h2>
						<h5>All property listings for sale or rent in bangalore</h5>
						<div class="col-md-12 wrapSearch">
							<div class="col-md-2 forsalerent">
								<button class="btn btn-default">Sale</button>
								<button class="btn btn-default">Rent</button>
							</div>
							<div class="col-md-10 filter">
								<ul>
									<li>Homes</li>
									<li>Commercial</li>
									<li>land</li>
									<li>other</li>
									<li>new Bulls</li>
									<li>student</li>
								</ul>
								<div class="multiselectTextBoxWrap">
									<ul class="multiseelctUl">
										<li>asdsad</li>
										<li>ad</li>
									</ul>
									<input disabled class="inputText" type="text" placeholder="">
								</div>
								
								<div class="col-md-12 row priceArea">
									<div class="col-md-3 row">
										<input class="" type="text" placeholder=" Price min ">
									</div>
									<div class="col-md-3" style="margin-left:20px;">
										<input class="" type="text" placeholder="Price max">
									</div>
									<div class="col-md-3">
										<select>
											<option>property type</option>
										</select>
									</div>
									<div class="col-md-3">
										<center>
											<button class="searchBtn btn">Search</button>
										</center>
									</div>
								</div>
								
							</div>
						</div>
					</div>	
				</div>
			</div>
		</div>
		
	</div>
	<script src="/js/lib/jquery.js" ></script>
	<script src="/js/lib/bootstrap.js" ></script>
	<script src="/js/locality.js" ></script>
	
</body>
</html>